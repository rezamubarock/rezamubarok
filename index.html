<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>./SYSTEM_ROOT/SECURE_ACCESS</title>
    <style>
        /* --- HACKER AESTHETIC CSS --- */
        :root {
            --bg-color: #050505;
            --primary-color: #00ff00;
            --dim-color: #004400;
            --alert-color: #ff0000;
            --font-stack: 'Courier New', Courier, monospace;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-color);
            color: var(--primary-color);
            font-family: var(--font-stack);
            overflow-x: hidden;
        }

        canvas {
            position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.15;
        }

        .container {
            max-width: 1000px; margin: 0 auto; padding: 20px; position: relative; z-index: 1;
        }

        /* Header */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 0; border-bottom: 2px solid var(--primary-color); margin-bottom: 30px;
        }
        h1 { text-transform: uppercase; text-shadow: 0 0 5px var(--primary-color); font-size: 1.5rem; }
        .blink { animation: blink 1s infinite; }

        /* Login/Admin Area */
        .admin-controls { display: flex; align-items: center; gap: 10px; }
        .secret-input {
            background: #000; border: 1px solid var(--dim-color); color: var(--primary-color);
            padding: 5px; font-family: inherit; width: 150px; transition: 0.3s;
        }
        .secret-input:focus { border-color: var(--primary-color); outline: none; }
        
        #logout-btn {
            display: none; background: var(--alert-color); color: white; border: none; 
            padding: 5px 10px; cursor: pointer; font-weight: bold; font-family: inherit;
        }

        #admin-status { 
            display: none; color: #000; background: var(--primary-color); 
            padding: 2px 8px; font-weight: bold; cursor: default; 
        }

        /* Tools Grid */
        .tools-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;
        }
        .tool-card {
            border: 1px solid var(--dim-color); padding: 20px; background: rgba(0, 20, 0, 0.6);
            transition: 0.3s; position: relative;
        }
        .tool-card:hover {
            border-color: var(--primary-color); box-shadow: 0 0 15px rgba(0, 255, 0, 0.2); transform: translateY(-3px);
        }
        .tool-card h3 { margin-bottom: 10px; color: #fff; }
        .tool-card p { font-size: 0.9rem; opacity: 0.8; margin-bottom: 15px; line-height: 1.4; }
        .btn-visit {
            display: inline-block; padding: 8px 15px; border: 1px solid var(--primary-color);
            text-decoration: none; color: var(--primary-color); font-size: 0.8rem; transition: 0.2s;
        }
        .btn-visit:hover { background: var(--primary-color); color: #000; }

        /* Edit Button (Admin Only) */
        .btn-edit {
            display: none; position: absolute; top: 15px; right: 15px;
            background: transparent; border: none; color: yellow; cursor: pointer; font-family: inherit;
        }
        .btn-edit:hover { text-decoration: underline; }

        /* Add Button */
        #add-tool-btn {
            display: none; width: 100%; padding: 15px; margin-top: 30px;
            background: transparent; border: 2px dashed var(--dim-color); color: var(--dim-color);
            font-family: inherit; cursor: pointer; font-size: 1.2rem;
        }
        #add-tool-btn:hover { border-color: var(--primary-color); color: var(--primary-color); }

        /* Modal */
        #modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 100;
        }
        .modal-box {
            background: #001100; border: 2px solid var(--primary-color); padding: 30px; width: 90%; max-width: 400px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
        }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-size: 0.8rem; }
        .input-group input, .input-group textarea {
            width: 100%; padding: 10px; background: #000; border: 1px solid var(--dim-color);
            color: var(--primary-color); font-family: inherit;
        }
        .modal-btns { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
        .btn { padding: 8px 20px; cursor: pointer; font-family: inherit; border: none; font-weight: bold; }
        .btn-save { background: var(--primary-color); color: black; }
        .btn-cancel { background: #330000; color: white; border: 1px solid var(--alert-color); }

        @keyframes blink { 50% { opacity: 0; } }
        .loader { text-align: center; margin-top: 50px; }
        .error-msg { color: var(--alert-color); font-size: 0.8rem; margin-top: 5px; display: none; text-align: right;}
    </style>
</head>
<body>

    <canvas id="matrix"></canvas>

    <div class="container">
        <header>
            <h1>System_Root<span class="blink">_</span></h1>
            <div class="wrapper-controls">
                <div class="admin-controls">
                    <div id="login-area">
                        <input type="password" id="secret-code" class="secret-input" placeholder="ENTER_ROOT_PASS">
                        <div id="login-msg" class="error-msg">ACCESS DENIED</div>
                    </div>
                    <div id="admin-area" style="display:none;">
                        <span id="admin-status">ADMIN ACCESS</span>
                        <button id="logout-btn" onclick="logout()">[LOGOUT]</button>
                    </div>
                </div>
            </div>
        </header>

        <div id="loader" class="loader">>> ESTABLISHING SECURE CONNECTION...</div>
        <div class="tools-grid" id="tools-container"></div>

        <button id="add-tool-btn" onclick="openModal()">+ INJECT NEW NODE</button>
    </div>

    <!-- Modal Form -->
    <div id="modal">
        <div class="modal-box">
            <h2 id="modal-title" style="margin-bottom: 20px; border-bottom: 1px solid #0f0; padding-bottom:10px;">>> CONFIGURATION</h2>
            <input type="hidden" id="edit-id">
            
            <div class="input-group">
                <label>TOOL_NAME:</label>
                <input type="text" id="inp-name">
            </div>
            <div class="input-group">
                <label>DESCRIPTION:</label>
                <textarea id="inp-desc" rows="3"></textarea>
            </div>
            <div class="input-group">
                <label>TARGET_URL:</label>
                <input type="text" id="inp-link" placeholder="https://...">
            </div>
            
            <div class="modal-btns">
                <button class="btn btn-cancel" onclick="closeModal()">ABORT</button>
                <button class="btn btn-save" onclick="saveData()">EXECUTE</button>
            </div>
        </div>
    </div>

    <!-- FIREBASE SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, orderBy, query } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // ---------------------------------------------------------
        // >>> TEMPEL KONFIGURASI FIREBASE DI SINI <<<
        // Config ini AMAN untuk publik karena dilindungi oleh Security Rules di server
        // ---------------------------------------------------------
        const firebaseConfig = {
          apiKey: "AIzaSyDsKSdRhxy9_uJ4usxb_nHf3D07VnDCHLY",
          authDomain: "rezamubarokcom-5cd97.firebaseapp.com",
          projectId: "rezamubarokcom-5cd97",
          storageBucket: "rezamubarokcom-5cd97.firebasestorage.app",
          messagingSenderId: "942638292328",
          appId: "1:942638292328:web:7d01b463c118c758b38add",
          measurementId: "G-GGCVT5CEGR"
        };
        // ---------------------------------------------------------

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const toolsCol = collection(db, "hacker_tools");

        // DOM Elements
        const container = document.getElementById('tools-container');
        const loader = document.getElementById('loader');
        const addBtn = document.getElementById('add-tool-btn');
        const secretInput = document.getElementById('secret-code');
        const loginMsg = document.getElementById('login-msg');
        const loginArea = document.getElementById('login-area');
        const adminArea = document.getElementById('admin-area');
        const logoutBtn = document.getElementById('logout-btn');
        const modal = document.getElementById('modal');

        // 1. AUTHENTICATION LOGIC (SECURE)
        // Kita memantau status login user secara realtime
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in
                loginArea.style.display = 'none';
                adminArea.style.display = 'flex';
                addBtn.style.display = 'block';
                logoutBtn.style.display = 'inline-block';
                document.querySelectorAll('.btn-edit').forEach(btn => btn.style.display = 'block');
            } else {
                // User is signed out
                loginArea.style.display = 'block';
                adminArea.style.display = 'none';
                addBtn.style.display = 'none';
                logoutBtn.style.display = 'none';
                document.querySelectorAll('.btn-edit').forEach(btn => btn.style.display = 'none');
            }
        });

        // Fungsi Login
        secretInput.addEventListener('keyup', async (e) => {
            if (e.key === 'Enter') {
                const password = e.target.value;
                loginMsg.style.display = 'none';
                
                try {
                    // Login ke Firebase (Proses cek password terjadi di server Google, bukan di browser)
                    // Kita hardcode email admin di sini karena email bukan rahasia, password yang rahasia.
                    await signInWithEmailAndPassword(auth, "admin@hacker.com", password);
                    e.target.value = ''; // Clear input
                } catch (error) {
                    loginMsg.style.display = 'block';
                    loginMsg.innerText = ">> INCORRECT PASSKEY";
                    console.error(error);
                }
            }
        });

        window.logout = () => {
            signOut(auth);
        }

        // 2. REALTIME DATA LISTENER
        const q = query(toolsCol, orderBy("name"));
        onSnapshot(q, (snapshot) => {
            loader.style.display = 'none';
            container.innerHTML = '';
            
            snapshot.forEach((docSnap) => {
                const tool = docSnap.data();
                const id = docSnap.id;
                const currentUser = auth.currentUser; // Cek status auth saat render
                
                const editBtnStyle = currentUser ? 'display:block;' : 'display:none;';

                const card = document.createElement('div');
                card.className = 'tool-card';
                card.innerHTML = `
                    <h3>> ${tool.name}</h3>
                    <p>${tool.desc}</p>
                    <a href="${tool.link}" target="_blank" class="btn-visit">LAUNCH</a>
                    <button class="btn-edit" style="${editBtnStyle}" onclick="window.editTool('${id}', '${tool.name}', '${tool.desc}', '${tool.link}')">[EDIT]</button>
                `;
                container.appendChild(card);
            });
        }, (error) => {
            loader.innerText = ">> ERROR: " + error.message;
        });

        // 3. Save Data (Diproteksi Security Rules juga)
        window.saveData = async () => {
            if (!auth.currentUser) return alert(">> ACCESS DENIED. PLEASE LOGIN.");

            const id = document.getElementById('edit-id').value;
            const name = document.getElementById('inp-name').value;
            const desc = document.getElementById('inp-desc').value;
            const link = document.getElementById('inp-link').value;

            if(!name || !link) return alert(">> ERROR: MISSING PARAMETERS");

            try {
                if(id) {
                    await updateDoc(doc(db, "hacker_tools", id), { name, desc, link });
                    alert(">> UPDATE SUCCESSFUL");
                } else {
                    await addDoc(toolsCol, { name, desc, link });
                    alert(">> INJECTION SUCCESSFUL");
                }
                closeModal();
            } catch (e) {
                alert(">> PERMISSION DENIED (Check Security Rules)");
            }
        }

        // Modal Helpers
        window.openModal = () => {
            document.getElementById('modal-title').innerText = ">> NEW INJECTION";
            document.getElementById('edit-id').value = "";
            document.getElementById('inp-name').value = "";
            document.getElementById('inp-desc').value = "";
            document.getElementById('inp-link').value = "";
            modal.style.display = 'flex';
        }

        window.editTool = (id, name, desc, link) => {
            document.getElementById('modal-title').innerText = ">> MODIFY NODE";
            document.getElementById('edit-id').value = id;
            document.getElementById('inp-name').value = name;
            document.getElementById('inp-desc').value = desc;
            document.getElementById('inp-link').value = link;
            modal.style.display = 'flex';
        }
        window.closeModal = () => { modal.style.display = 'none'; }
    </script>

    <script>
        // Matrix Rain Effect
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const chars = '01ABCDEF'; 
        const drops = Array(Math.floor(canvas.width/14)).fill(1);
        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0F0'; ctx.font = '14px monospace';
            drops.forEach((y, i) => {
                const text = chars[Math.floor(Math.random()*chars.length)];
                ctx.fillText(text, i*14, y*14);
                if(y*14 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            });
        }
        setInterval(draw, 35);
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
    </script>
</body>
</html>
